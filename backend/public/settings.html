<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link 
        rel="stylesheet"
        href="templateStyle.css"
        >
        <link
        rel="icon"
        type="image/png"
        href="assets/logo_large.png"
        >
        <!--imports Bootstrap -->
        <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
      integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
      crossorigin="anonymous"
    ></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <!--imports google font icons-->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        
        <title>Settings</title>
 
        
    <!--local version of bootstrap css
      <link href="../bootstrap-5.3.3-examples/assets/dist/css/bootstrap.min.css" rel="stylesheet">-->
        
    </head>
    <body>
        <!--'go to top' button
        <a href="#"><div id="goToTopBtn">
            <img src="assets/arrow_up_full.svg" alt="Go to top">
        </div></a>
      -->
        
        <div class="b-example-divider"></div>

  <header class="p-1">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
        <img src="assets/logo_large.png" alt="Productivity Cabin">
        <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
          <!--<li><a href="#" class="nav-link px-2 link-secondary">Overview</a></li>
          <li><a href="#" class="nav-link px-2 link-body-emphasis">Inventory</a></li>
          <li><a href="#" class="nav-link px-2 link-body-emphasis">Customers</a></li>
          <li><a href="#" class="nav-link px-2 link-body-emphasis">Products</a></li>-->
        </ul>

        <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search">
          <input type="search" class="form-control" placeholder="Search..." aria-label="Search">
        </form>

        <div class="dropdown text-end">
          <a href="#" class="d-block link-body-emphasis text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            <img src="assets/logo_large.png" alt="mdo" width="32" height="32" class="rounded-circle">
          </a>
          <!--TODO: doesn't work-->
          <ul class="dropdown-menu text-small">
            <li><a class="dropdown-item" href="/settings">Settings</a></li>
            <li><hr class="dropdown-divider" /></li>
            <li><a class="dropdown-item" href="/signout">Sign out</a></li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <nav>
    <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link" href="/projects"><img src="assets/menu.svg" alt="Projects">Projects</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/overview"><img src="assets/overview_menu_icon.svg" alt="Overview">Overview</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="procutivityCabin.html"><img src="assets/productivity_cabin_page.svg" alt="Productivity Cabin">Productivity Cabin</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" aria-current="page" href="/productivity"><img src="assets/menu.svg" alt="Menu">Productivity Log</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/deadlines"><img src="assets/deadline.svg" alt="Deadlines">Deadlines</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="/settings"><img src="assets/account_settings.svg" alt="Settings">Settings</a>
        </li>
      </ul>

</nav>
        
        <article>
          <div id="centeredContent">
          <form method="post" action="/accUpdate" id="formId">
            <div style="display: flex; justify-content: space-between;">
            <h1>Settings</h1>
            <span>
              <input type="submit" value="Save">
              <!-- <a id = "returnBtnAnchor" href="overview.html"><div id="returnBtn">Cancel</div></a> -->
            </span>
          </div>
          <fieldset>
            <legend>Profile Information</legend>
            <div>
              <!-- <img id="profilePicture" src="assets/logo_large.png" alt="profile picture"> -->
              <!-- <label for="profilepic">Change profile picture</lable> -->
              <!-- <input type="file" accept=".jpg, .png, .jpeg" id="profilepic" name="profilepic"> -->
            </div>
            
            <label for="fname">First Name</label><br>
            <input type="text" name="fname" id="fname" placeholder="firstname"><br>

            <label for="sname">Surname</label><br>
            <input type="text" name="sname" id="sname" placeholder="Surname"><br>
          </fieldset>
            <br>
          <fieldset>
            <legend>Account Safety</legend>
            <!-- <label for="currentPwd">Current Password</label><br>
            <input type="password" id="currentPwd" name="currentPwd" placeholder="enter your current password..."><br> -->

            <label for="newPwd">Enter the New Password</label><br>
            <input type="password" id="newPwd" name="newPwd" placeholder="enter the new password..." ><br>

            <!-- <label for="confirmPwd">Confirm the New Password</label><br>
            <input type="password" id="confirmPwd" name="confirmPwd" placeholder="re-enter the new password..."><br> -->
          </fieldset>
          </form>
          </div>
        </article>
    </body>
    <script defer>
      window.onload = function(){
       fetch(`/settings/${localStorage.getItem("userId")}`).then(function(result){
        return result.json()
        
       }).then(function(result){
        document.getElementById("fname").value = result.firstName;
        document.getElementById("sname").value = result.lastName;
        document.getElementById("newPwd").value = result.password;
       })
      }
      document.getElementById("formId").addEventListener("submit", async function(e){
        e.preventDefault();
    const response = await fetch(`/settings/accUpdate/${localStorage.getItem("userId")}`, {
        method: "PUT",
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            fname: document.getElementById("fname").value,
            sname: document.getElementById("sname").value,
            newPwd: document.getElementById("newPwd").value
        })

 });


 const data = await response.json();
 alert(data.message);

 })
      
    </script>
</html>